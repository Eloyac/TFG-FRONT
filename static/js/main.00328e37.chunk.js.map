{"version":3,"sources":["pages/Home.js","pages/Login.js","pages/Register.js","pages/Games.js","socket.js","pages/Chat.js","pages/Game.js","components/ProtectedRoute.js","App.js","index.js"],"names":["Home","navigate","useNavigate","_jsxs","children","_jsx","onClick","async","token","localStorage","getItem","console","error","response","axios","post","concat","process","headers","_id","gameId","data","Login","email","setEmail","useState","password","setPassword","onSubmit","e","preventDefault","res","log","setItem","err","type","value","onChange","target","Register","name","setName","Games","games","setGames","setError","API_URL","useEffect","get","fetchGames","map","game","player1","player2","result","socket","io","autoConnect","query","on","Chat","_ref","messages","setMessages","message","setMessage","emit","prevMessages","off","List","msg","index","ListItem","ListItemText","primary","text","TextField","fullWidth","margin","Button","variant","color","Game","useParams","setGame","Chess","connect","move","newGame","fen","disconnect","savedGame","boardState","fetchGame","Chessboard","position","onPieceDrop","sourceSquare","targetSquare","handleMove","from","to","promotion","in_checkmate","turn","in_draw","handleResult","ProtectedRoute","Navigate","App","Router","Routes","Route","path","element","ReactDOM","render","React","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.00328e37.chunk.js","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Home = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const createGame = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token'); // Obtener el token del localStorage\r\n      if (!token) {\r\n        console.error('No token found');\r\n        return;\r\n      }\r\n\r\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/games/create`, {}, {\r\n        headers: {\r\n          'x-auth-token': token, // Enviar el token en los encabezados de la solicitud\r\n        }\r\n      });\r\n      const { _id: gameId } = response.data;\r\n      navigate(`/game/${gameId}`);\r\n    } catch (error) {\r\n      console.error('Error creating game', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Welcome to FESACHESS</h1>\r\n      <button onClick={createGame}>Create New Game</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import React, { useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Login = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/api/auth/login`, { email, password });\r\n      console.log(res.data);\r\n      // Almacena el token JWT en el localStorage o maneja el login de otra manera\r\n      localStorage.setItem('token', res.data.token);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Login</h1>\r\n      <form onSubmit={handleLogin}>\r\n        <div>\r\n          <label>Email:</label>\r\n          <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} />\r\n        </div>\r\n        <div>\r\n          <label>Password:</label>\r\n          <input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} />\r\n        </div>\r\n        <button type=\"submit\">Login</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Register = () => {\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n\r\n  const handleRegister = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/api/auth/register`, { name, email, password });\r\n      console.log(res.data);\r\n      // Almacena el token JWT en el localStorage o maneja el registro de otra manera\r\n      localStorage.setItem('token', res.data.token);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Register</h1>\r\n      <form onSubmit={handleRegister}>\r\n        <div>\r\n          <label>Name:</label>\r\n          <input type=\"text\" value={name} onChange={(e) => setName(e.target.value)} />\r\n        </div>\r\n        <div>\r\n          <label>Email:</label>\r\n          <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} />\r\n        </div>\r\n        <div>\r\n          <label>Password:</label>\r\n          <input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} />\r\n        </div>\r\n        <button type=\"submit\">Register</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n","import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Games = () => {\r\n  const [games, setGames] = useState([]);\r\n  const [error, setError] = useState('');\r\n\r\n  const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n  useEffect(() => {\r\n    const fetchGames = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const response = await axios.get(`${API_URL}/api/games/mygames`, {\r\n          headers: { 'x-auth-token': token }\r\n        });\r\n        setGames(response.data);\r\n      } catch (error) {\r\n        setError('Error fetching games');\r\n      }\r\n    };\r\n\r\n    fetchGames();\r\n  }, [API_URL]);\r\n\r\n  return (\r\n    <div>\r\n      <h1>My Games</h1>\r\n      {error && <p>{error}</p>}\r\n      <ul>\r\n        {games.map((game) => (\r\n          <li key={game._id}>\r\n            Game between {game.player1} and {game.player2} - Result: {game.result}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Games;\r\n","import { io } from 'socket.io-client';\r\n\r\nconst SOCKET_URL = 'https://tfg-back.onrender.com'; // Actualiza la URL para que coincida con el backend en Render\r\n\r\nconst token = localStorage.getItem('token');\r\n\r\nexport const socket = io(SOCKET_URL, {\r\n  autoConnect: false,\r\n  query: { token },\r\n});\r\n\r\nsocket.on('connect', () => {\r\n  console.log('Connected to socket.io server');\r\n});\r\n\r\nsocket.on('disconnect', () => {\r\n  console.log('Disconnected from socket.io server');\r\n});\r\n","import React, { useState, useEffect } from 'react';\r\nimport { socket } from '../socket';\r\nimport { TextField, Button, List, ListItem, ListItemText } from '@mui/material';\r\n\r\nconst Chat = ({ gameId }) => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    socket.emit('joinGame', gameId);\r\n\r\n    socket.on('message', (message) => {\r\n      setMessages((prevMessages) => [...prevMessages, message]);\r\n    });\r\n\r\n    return () => {\r\n      socket.emit('leaveGame', gameId);\r\n      socket.off('message');\r\n    };\r\n  }, [gameId]);\r\n\r\n  const sendMessage = (e) => {\r\n    e.preventDefault();\r\n    socket.emit('sendMessage', { gameId, text: message });\r\n    setMessage('');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <List>\r\n        {messages.map((msg, index) => (\r\n          <ListItem key={index}>\r\n            <ListItemText primary={msg.text} />\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n      <form onSubmit={sendMessage}>\r\n        <TextField\r\n          type=\"text\"\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <Button type=\"submit\" variant=\"contained\" color=\"primary\">\r\n          Send\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Chessboard } from 'react-chessboard';\r\nimport { Chess } from 'chess.js';\r\nimport { socket } from '../socket';\r\nimport { useParams } from 'react-router-dom';\r\nimport Chat from './Chat';\r\nimport axios from 'axios';\r\n\r\nconst Game = () => {\r\n  const { gameId } = useParams(); // Obtener el gameId de la URL\r\n  const [game, setGame] = useState(new Chess());\r\n\r\n  useEffect(() => {\r\n    socket.connect();\r\n\r\n    socket.emit('joinGame', gameId);\r\n\r\n    socket.on('move', (move) => {\r\n      const newGame = new Chess(game.fen());\r\n      newGame.move(move);\r\n      setGame(newGame);\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [game, gameId]);\r\n\r\n  useEffect(() => {\r\n    const fetchGame = async () => {\r\n      const response = await axios.get(`${process.env.REACT_APP_API_URL}/api/games/${gameId}`, {\r\n        headers: {\r\n          'x-auth-token': localStorage.getItem('token'),\r\n        }\r\n      });\r\n      const savedGame = new Chess(response.data.boardState);\r\n      setGame(savedGame);\r\n    };\r\n\r\n    fetchGame();\r\n  }, [gameId]);\r\n\r\n  const handleResult = (game) => {\r\n    if (game.in_checkmate()) {\r\n      if (game.turn() === 'b') {\r\n        // Player 1 (white) wins\r\n        return 'player1';\r\n      } else {\r\n        // Player 2 (black) wins\r\n        return 'player2';\r\n      }\r\n    } else if (game.in_draw()) {\r\n      return 'draw';\r\n    }\r\n    return 'ongoing';\r\n  };\r\n\r\n  const handleMove = (sourceSquare, targetSquare) => {\r\n    const newGame = new Chess(game.fen());\r\n    const move = newGame.move({\r\n      from: sourceSquare,\r\n      to: targetSquare,\r\n      promotion: 'q',\r\n    });\r\n    if (move === null) return;\r\n\r\n    const result = handleResult(newGame);\r\n    setGame(newGame);\r\n    socket.emit('move', { gameId, move, fen: newGame.fen(), turn: newGame.turn(), result });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Game</h1>\r\n      <Chessboard\r\n        position={game.fen()}\r\n        onPieceDrop={(sourceSquare, targetSquare) => handleMove(sourceSquare, targetSquare)}\r\n      />\r\n      <Chat gameId={gameId} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n","import React from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  const token = localStorage.getItem('token');\r\n  return token ? children : <Navigate to=\"/login\" />;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n","import React from 'react';\r\nimport { BrowserRouter as Router, Route, Routes } from 'react-router-dom';\r\nimport Home from './pages/Home';\r\nimport Login from './pages/Login';\r\nimport Register from './pages/Register';\r\nimport Games from './pages/Games';\r\nimport Game from './pages/Game';\r\nimport ProtectedRoute from './components/ProtectedRoute';\r\n\r\nfunction App() {\r\n  return (\r\n    <Router>\r\n      <Routes>\r\n        <Route path=\"/\" element={<Login />} />\r\n        <Route path=\"/login\" element={<Login />} />\r\n        <Route path=\"/register\" element={<Register />} />\r\n        <Route\r\n          path=\"/home\"\r\n          element={\r\n            <ProtectedRoute>\r\n              <Home />\r\n            </ProtectedRoute>\r\n          }\r\n        />\r\n        <Route\r\n          path=\"/games\"\r\n          element={\r\n            <ProtectedRoute>\r\n              <Games />\r\n            </ProtectedRoute>\r\n          }\r\n        />\r\n        <Route\r\n          path=\"/game/:gameId\"\r\n          element={\r\n            <ProtectedRoute>\r\n              <Game />\r\n            </ProtectedRoute>\r\n          }\r\n        />\r\n      </Routes>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}