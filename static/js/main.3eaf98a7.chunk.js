(this["webpackJsonpfesachess-frontend"]=this["webpackJsonpfesachess-frontend"]||[]).push([[0],{146:function(e,t,c){},147:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c.n(a),s=c(28),o=c.n(s),r=c(60),j=c(5),i=c(1);var l=()=>Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"FESACHESS"}),Object(i.jsx)("p",{children:"Welcome to FESACHESS, the online chess game."})]}),d=c(37),O=c.n(d);var b=()=>{const[e,t]=Object(a.useState)(""),[c,n]=Object(a.useState)(""),[s,o]=Object(a.useState)(""),r=Object({NODE_ENV:"production",PUBLIC_URL:"/TFG-FRONT",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL;return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Login"}),Object(i.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await O.a.post("".concat(r,"/api/auth/login"),{email:e,password:c});console.log(t.data)}catch(s){o("Invalid credentials")}},children:[Object(i.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value)}),Object(i.jsx)("input",{type:"password",placeholder:"Password",value:c,onChange:e=>n(e.target.value)}),Object(i.jsx)("button",{type:"submit",children:"Login"}),s&&Object(i.jsx)("p",{children:s})]})]})};var u=()=>{const[e,t]=Object(a.useState)(""),[c,n]=Object(a.useState)(""),[s,o]=Object(a.useState)(""),[r,j]=Object(a.useState)(""),l=Object({NODE_ENV:"production",PUBLIC_URL:"/TFG-FRONT",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL;return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Register"}),Object(i.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await O.a.post("".concat(l,"/api/auth/register"),{username:e,email:c,password:s});console.log(t.data)}catch(r){j("Error registering user")}},children:[Object(i.jsx)("input",{type:"text",placeholder:"Username",value:e,onChange:e=>t(e.target.value)}),Object(i.jsx)("input",{type:"email",placeholder:"Email",value:c,onChange:e=>n(e.target.value)}),Object(i.jsx)("input",{type:"password",placeholder:"Password",value:s,onChange:e=>o(e.target.value)}),Object(i.jsx)("button",{type:"submit",children:"Register"}),r&&Object(i.jsx)("p",{children:r})]})]})},h=c(95),m=c(52),p=c(99);const g=localStorage.getItem("token"),x=Object(p.a)("http://localhost:5000",{autoConnect:!1,query:{token:g}});x.on("connect",(()=>{console.log("Connected to socket.io server")})),x.on("disconnect",(()=>{console.log("Disconnected from socket.io server")}));var S=c(200),v=c(197),_=c(198),E=c(195),f=c(199);var T=e=>{let{gameId:t}=e;const[c,n]=Object(a.useState)([]),[s,o]=Object(a.useState)("");Object(a.useEffect)((()=>(x.emit("joinGame",t),x.on("message",(e=>{n((t=>[...t,e]))})),()=>{x.emit("leaveGame",t),x.off("message")})),[t]);return Object(i.jsxs)("div",{children:[Object(i.jsx)(S.a,{children:c.map(((e,t)=>Object(i.jsx)(v.a,{children:Object(i.jsx)(_.a,{primary:e.text})},t)))}),Object(i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x.emit("sendMessage",{gameId:t,text:s}),o("")},children:[Object(i.jsx)(E.a,{type:"text",value:s,onChange:e=>o(e.target.value),fullWidth:!0,margin:"normal"}),Object(i.jsx)(f.a,{type:"submit",variant:"contained",color:"primary",children:"Send"})]})]})};var y=()=>{const{gameId:e}=Object(j.r)(),[t,c]=Object(a.useState)(new m.a);Object(a.useEffect)((()=>(x.connect(),x.on("move",(e=>{const a=new m.a(t.fen());a.move(e),c(a)})),()=>{x.disconnect()})),[t]),Object(a.useEffect)((()=>{(async()=>{const t=await O.a.get("http://localhost:5000/api/games/".concat(e)),a=new m.a(t.data.boardState);c(a)})()}),[e]);return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Game"}),Object(i.jsx)(h.a,{position:t.fen(),onPieceDrop:(a,n)=>((a,n)=>{const s=new m.a(t.fen()),o=s.move({from:a,to:n,promotion:"q"});if(null===o)return;const r=(e=>e.in_checkmate()?"b"===e.turn()?"player1":"player2":e.in_draw()?"draw":"ongoing")(s);c(s),x.emit("move",{gameId:e,move:o,fen:s.fen(),turn:s.turn(),result:r})})(a,n)}),Object(i.jsx)(T,{gameId:e})]})};var C=()=>{const[e,t]=Object(a.useState)([]),[c,n]=Object(a.useState)(""),s=Object({NODE_ENV:"production",PUBLIC_URL:"/TFG-FRONT",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL;return Object(a.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),c=await O.a.get("".concat(s,"/api/games/mygames"),{headers:{"x-auth-token":e}});t(c.data)}catch(c){n("Error fetching games")}})()}),[s]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"My Games"}),c&&Object(i.jsx)("p",{children:c}),Object(i.jsx)("ul",{children:e.map((e=>Object(i.jsxs)("li",{children:["Game between ",e.player1," and ",e.player2," - Result: ",e.result]},e._id)))})]})};var R=e=>{let{children:t}=e;return localStorage.getItem("token")?t:Object(i.jsx)(j.a,{to:"/login"})};var P=function(){return Object(i.jsx)(r.a,{children:Object(i.jsxs)(j.d,{children:[Object(i.jsx)(j.b,{path:"/",element:Object(i.jsx)(l,{})}),Object(i.jsx)(j.b,{path:"/login",element:Object(i.jsx)(b,{})}),Object(i.jsx)(j.b,{path:"/register",element:Object(i.jsx)(u,{})}),Object(i.jsx)(j.b,{path:"/games",element:Object(i.jsx)(R,{children:Object(i.jsx)(C,{})})}),Object(i.jsx)(j.b,{path:"/game/:gameId",element:Object(i.jsx)(R,{children:Object(i.jsx)(y,{})})})]})})};c(146);o.a.render(Object(i.jsx)(n.a.StrictMode,{children:Object(i.jsx)(P,{})}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.3eaf98a7.chunk.js.map