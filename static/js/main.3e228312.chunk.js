(this["webpackJsonpfesachess-frontend"]=this["webpackJsonpfesachess-frontend"]||[]).push([[0],{146:function(e,t,a){},147:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(28),r=a.n(s),o=a(60),j=a(5),i=a(29),l=a.n(i),b=a(1);var d=()=>{const e=Object(j.o)();return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Welcome to FESACHESS"}),Object(b.jsx)("button",{onClick:async()=>{try{const t=await l.a.post("https://tfg-back.onrender.com/api/games/create",{},{headers:{"x-auth-token":localStorage.getItem("token")}}),{gameId:a}=t.data;e("/game/".concat(a))}catch(t){console.error("Error creating game",t)}},children:"Create New Game"})]})};var m=()=>{const[e,t]=Object(c.useState)(""),[a,n]=Object(c.useState)(""),[s,r]=Object(c.useState)("");return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await l.a.post("".concat("https://tfg-back.onrender.com","/api/auth/login"),{email:e,password:a});console.log(t.data)}catch(s){r("Invalid credentials")}},children:[Object(b.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value)}),Object(b.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>n(e.target.value)}),Object(b.jsx)("button",{type:"submit",children:"Login"}),s&&Object(b.jsx)("p",{children:s})]})]})};var u=()=>{const[e,t]=Object(c.useState)(""),[a,n]=Object(c.useState)(""),[s,r]=Object(c.useState)(""),[o,j]=Object(c.useState)("");return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Register"}),Object(b.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await l.a.post("".concat("https://tfg-back.onrender.com","/api/auth/register"),{username:e,email:a,password:s});console.log(t.data)}catch(o){j("Error registering user")}},children:[Object(b.jsx)("input",{type:"text",placeholder:"Username",value:e,onChange:e=>t(e.target.value)}),Object(b.jsx)("input",{type:"email",placeholder:"Email",value:a,onChange:e=>n(e.target.value)}),Object(b.jsx)("input",{type:"password",placeholder:"Password",value:s,onChange:e=>r(e.target.value)}),Object(b.jsx)("button",{type:"submit",children:"Register"}),o&&Object(b.jsx)("p",{children:o})]})]})};var h=()=>{const[e,t]=Object(c.useState)([]),[a,n]=Object(c.useState)(""),s="https://tfg-back.onrender.com";return Object(c.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await l.a.get("".concat(s,"/api/games/mygames"),{headers:{"x-auth-token":e}});t(a.data)}catch(a){n("Error fetching games")}})()}),[s]),Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"My Games"}),a&&Object(b.jsx)("p",{children:a}),Object(b.jsx)("ul",{children:e.map((e=>Object(b.jsxs)("li",{children:["Game between ",e.player1," and ",e.player2," - Result: ",e.result]},e._id)))})]})},O=a(95),g=a(52),p=a(99);const x=localStorage.getItem("token"),v=Object(p.a)("http://localhost:5000",{autoConnect:!1,query:{token:x}});v.on("connect",(()=>{console.log("Connected to socket.io server")})),v.on("disconnect",(()=>{console.log("Disconnected from socket.io server")}));var f=a(200),y=a(197),S=a(198),w=a(195),k=a(199);var I=e=>{let{gameId:t}=e;const[a,n]=Object(c.useState)([]),[s,r]=Object(c.useState)("");Object(c.useEffect)((()=>(v.emit("joinGame",t),v.on("message",(e=>{n((t=>[...t,e]))})),()=>{v.emit("leaveGame",t),v.off("message")})),[t]);return Object(b.jsxs)("div",{children:[Object(b.jsx)(f.a,{children:a.map(((e,t)=>Object(b.jsx)(y.a,{children:Object(b.jsx)(S.a,{primary:e.text})},t)))}),Object(b.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v.emit("sendMessage",{gameId:t,text:s}),r("")},children:[Object(b.jsx)(w.a,{type:"text",value:s,onChange:e=>r(e.target.value),fullWidth:!0,margin:"normal"}),Object(b.jsx)(k.a,{type:"submit",variant:"contained",color:"primary",children:"Send"})]})]})};var E=()=>{const{gameId:e}=Object(j.q)(),[t,a]=Object(c.useState)(new g.a);Object(c.useEffect)((()=>(v.connect(),v.emit("joinGame",e),v.on("move",(e=>{const c=new g.a(t.fen());c.move(e),a(c)})),()=>{v.disconnect()})),[t,e]),Object(c.useEffect)((()=>{(async()=>{const t=await l.a.get("https://tfg-back.onrender.com/api/games/".concat(e),{headers:{"x-auth-token":localStorage.getItem("token")}}),c=new g.a(t.data.boardState);a(c)})()}),[e]);return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Game"}),Object(b.jsx)(O.a,{position:t.fen(),onPieceDrop:(c,n)=>((c,n)=>{const s=new g.a(t.fen()),r=s.move({from:c,to:n,promotion:"q"});if(null===r)return;const o=(e=>e.in_checkmate()?"b"===e.turn()?"player1":"player2":e.in_draw()?"draw":"ongoing")(s);a(s),v.emit("move",{gameId:e,move:r,fen:s.fen(),turn:s.turn(),result:o})})(c,n)}),Object(b.jsx)(I,{gameId:e})]})};var C=function(){return Object(b.jsx)(o.a,{basename:"/",children:Object(b.jsxs)(j.c,{children:[Object(b.jsx)(j.a,{path:"/",element:Object(b.jsx)(d,{})}),Object(b.jsx)(j.a,{path:"/login",element:Object(b.jsx)(m,{})}),Object(b.jsx)(j.a,{path:"/register",element:Object(b.jsx)(u,{})}),Object(b.jsx)(j.a,{path:"/games",element:Object(b.jsx)(h,{})}),Object(b.jsx)(j.a,{path:"/game/:gameId",element:Object(b.jsx)(E,{})})]})})};a(146);r.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(C,{})}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.3e228312.chunk.js.map