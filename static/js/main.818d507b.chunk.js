(this["webpackJsonpfesachess-frontend"]=this["webpackJsonpfesachess-frontend"]||[]).push([[0],{146:function(e,t,a){},147:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(28),s=a.n(o),r=a(43),i=a(5),j=a(29),l=a.n(j),d=a(1);var m=()=>{const e=Object(i.o)();return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Welcome to FESACHESS"}),Object(d.jsx)("button",{onClick:async()=>{try{const t=localStorage.getItem("token");if(!t)return void console.error("No token found");const a=await l.a.post("https://tfg-back.onrender.com/api/games/create",{},{headers:{"x-auth-token":t}}),{gameId:n}=a.data;e("/game/".concat(n))}catch(t){console.error("Error creating game",t)}},children:"Create New Game"})]})};var b=()=>{const[e,t]=Object(n.useState)({email:"",password:""}),a=Object(i.o)(),{email:c,password:o}=e,s=a=>t({...e,[a.target.name]:a.target.value});return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Login"}),Object(d.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await l.a.post("https://tfg-back.onrender.com/api/auth/login",e);localStorage.setItem("token",t.data.token),a("/")}catch(n){console.error(n.response.data)}},children:[Object(d.jsx)("input",{type:"email",placeholder:"Email",name:"email",value:c,onChange:s,required:!0}),Object(d.jsx)("input",{type:"password",placeholder:"Password",name:"password",value:o,onChange:s,required:!0}),Object(d.jsx)("button",{type:"submit",children:"Login"})]})]})};var u=()=>{const[e,t]=Object(n.useState)({name:"",email:"",password:""}),a=Object(i.o)(),{name:c,email:o,password:s}=e,r=a=>t({...e,[a.target.name]:a.target.value});return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Register"}),Object(d.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await l.a.post("https://tfg-back.onrender.com/api/auth/register",e);localStorage.setItem("token",t.data.token),a("/")}catch(n){console.error(n.response.data)}},children:[Object(d.jsx)("input",{type:"text",placeholder:"Name",name:"name",value:c,onChange:r,required:!0}),Object(d.jsx)("input",{type:"email",placeholder:"Email",name:"email",value:o,onChange:r,required:!0}),Object(d.jsx)("input",{type:"password",placeholder:"Password",name:"password",value:s,onChange:r,required:!0}),Object(d.jsx)("button",{type:"submit",children:"Register"})]})]})};var h=()=>{const[e,t]=Object(n.useState)([]),[a,c]=Object(n.useState)(""),o=Object({NODE_ENV:"production",PUBLIC_URL:"/TFG-FRONT",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL;return Object(n.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await l.a.get("".concat(o,"/api/games/mygames"),{headers:{"x-auth-token":e}});t(a.data)}catch(a){c("Error fetching games")}})()}),[o]),Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"My Games"}),a&&Object(d.jsx)("p",{children:a}),Object(d.jsx)("ul",{children:e.map((e=>Object(d.jsxs)("li",{children:["Game between ",e.player1," and ",e.player2," - Result: ",e.result]},e._id)))})]})},O=a(95),p=a(53),g=a(99);const x=localStorage.getItem("token"),v=Object(g.a)("http://localhost:5000",{autoConnect:!1,query:{token:x}});v.on("connect",(()=>{console.log("Connected to socket.io server")})),v.on("disconnect",(()=>{console.log("Disconnected from socket.io server")}));var f=a(200),S=a(197),y=a(198),w=a(195),k=a(199);var E=e=>{let{gameId:t}=e;const[a,c]=Object(n.useState)([]),[o,s]=Object(n.useState)("");Object(n.useEffect)((()=>(v.emit("joinGame",t),v.on("message",(e=>{c((t=>[...t,e]))})),()=>{v.emit("leaveGame",t),v.off("message")})),[t]);return Object(d.jsxs)("div",{children:[Object(d.jsx)(f.a,{children:a.map(((e,t)=>Object(d.jsx)(S.a,{children:Object(d.jsx)(y.a,{primary:e.text})},t)))}),Object(d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v.emit("sendMessage",{gameId:t,text:o}),s("")},children:[Object(d.jsx)(w.a,{type:"text",value:o,onChange:e=>s(e.target.value),fullWidth:!0,margin:"normal"}),Object(d.jsx)(k.a,{type:"submit",variant:"contained",color:"primary",children:"Send"})]})]})};var C=()=>{const{gameId:e}=Object(i.q)(),[t,a]=Object(n.useState)(new p.a);Object(n.useEffect)((()=>(v.connect(),v.emit("joinGame",e),v.on("move",(e=>{const n=new p.a(t.fen());n.move(e),a(n)})),()=>{v.disconnect()})),[t,e]),Object(n.useEffect)((()=>{(async()=>{const t=await l.a.get("https://tfg-back.onrender.com/api/games/".concat(e),{headers:{"x-auth-token":localStorage.getItem("token")}}),n=new p.a(t.data.boardState);a(n)})()}),[e]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Game"}),Object(d.jsx)(O.a,{position:t.fen(),onPieceDrop:(n,c)=>((n,c)=>{const o=new p.a(t.fen()),s=o.move({from:n,to:c,promotion:"q"});if(null===s)return;const r=(e=>e.in_checkmate()?"b"===e.turn()?"player1":"player2":e.in_draw()?"draw":"ongoing")(o);a(o),v.emit("move",{gameId:e,move:s,fen:o.fen(),turn:o.turn(),result:r})})(n,c)}),Object(d.jsx)(E,{gameId:e})]})};var I=function(){return Object(d.jsx)(r.a,{basename:"/",children:Object(d.jsxs)(i.c,{children:[Object(d.jsx)(i.a,{path:"/",element:Object(d.jsx)(m,{})}),Object(d.jsx)(i.a,{path:"/login",element:Object(d.jsx)(b,{})}),Object(d.jsx)(i.a,{path:"/register",element:Object(d.jsx)(u,{})}),Object(d.jsx)(i.a,{path:"/games",element:Object(d.jsx)(h,{})}),Object(d.jsx)(i.a,{path:"/game/:gameId",element:Object(d.jsx)(C,{})})," "]})})};a(146);s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(I,{})}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.818d507b.chunk.js.map