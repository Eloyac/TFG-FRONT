(this["webpackJsonpfesachess-frontend"]=this["webpackJsonpfesachess-frontend"]||[]).push([[0],{149:function(e,t,a){},150:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(28),s=a.n(r),o=a(40),l=a(6),i=a(1);var j=()=>Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"FESACHESS"}),Object(i.jsx)("p",{children:"Welcome to FESACHESS, the online chess game."})]}),d=a(32),m=a.n(d),b=a(199),h=a(201),u=a(196),O=a(200);var g=()=>{const[e,t]=Object(n.useState)(""),[a,c]=Object(n.useState)(""),[r,s]=Object(n.useState)(""),o=Object(l.p)();return Object(i.jsxs)(b.a,{maxWidth:"sm",children:[Object(i.jsx)(h.a,{variant:"h4",component:"h1",gutterBottom:!0,children:"Login"}),Object(i.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await m.a.post("http://localhost:5000/api/auth/login",{email:e,password:a});localStorage.setItem("token",t.data.token),o("/games")}catch(r){s("Invalid credentials")}},children:[Object(i.jsx)(u.a,{label:"Email",type:"email",value:e,onChange:e=>t(e.target.value),fullWidth:!0,margin:"normal",required:!0}),Object(i.jsx)(u.a,{label:"Password",type:"password",value:a,onChange:e=>c(e.target.value),fullWidth:!0,margin:"normal",required:!0}),Object(i.jsx)(O.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Login"})]}),r&&Object(i.jsx)(h.a,{color:"error",children:r})]})};var p=()=>{const[e,t]=Object(n.useState)(""),[a,c]=Object(n.useState)(""),[r,s]=Object(n.useState)(""),[o,j]=Object(n.useState)(""),d=Object(l.p)();return Object(i.jsxs)(b.a,{maxWidth:"sm",children:[Object(i.jsx)(h.a,{variant:"h4",component:"h1",gutterBottom:!0,children:"Register"}),Object(i.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{await m.a.post("http://localhost:5000/api/auth/register",{username:e,email:a,password:r}),d("/login")}catch(o){j("Registration failed")}},children:[Object(i.jsx)(u.a,{label:"Username",type:"text",value:e,onChange:e=>t(e.target.value),fullWidth:!0,margin:"normal",required:!0}),Object(i.jsx)(u.a,{label:"Email",type:"email",value:a,onChange:e=>c(e.target.value),fullWidth:!0,margin:"normal",required:!0}),Object(i.jsx)(u.a,{label:"Password",type:"password",value:r,onChange:e=>s(e.target.value),fullWidth:!0,margin:"normal",required:!0}),Object(i.jsx)(O.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Register"})]}),o&&Object(i.jsx)(h.a,{color:"error",children:o})]})},x=a(99),v=a(56),f=a(101);const y=localStorage.getItem("token"),S=Object(f.a)("http://localhost:5000",{autoConnect:!1,query:{token:y}});S.on("connect",(()=>{console.log("Connected to socket.io server")})),S.on("disconnect",(()=>{console.log("Disconnected from socket.io server")}));var w=a(202),k=a(198),I=a(203);var C=e=>{let{gameId:t}=e;const[a,c]=Object(n.useState)([]),[r,s]=Object(n.useState)("");Object(n.useEffect)((()=>(S.emit("joinGame",t),S.on("message",(e=>{c((t=>[...t,e]))})),()=>{S.emit("leaveGame",t),S.off("message")})),[t]);return Object(i.jsxs)("div",{children:[Object(i.jsx)(w.a,{children:a.map(((e,t)=>Object(i.jsx)(k.a,{children:Object(i.jsx)(I.a,{primary:e.text})},t)))}),Object(i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),S.emit("sendMessage",{gameId:t,text:r}),s("")},children:[Object(i.jsx)(u.a,{type:"text",value:r,onChange:e=>s(e.target.value),fullWidth:!0,margin:"normal"}),Object(i.jsx)(O.a,{type:"submit",variant:"contained",color:"primary",children:"Send"})]})]})};var E=()=>{const{gameId:e}=Object(l.r)(),[t,a]=Object(n.useState)(new v.a);Object(n.useEffect)((()=>(S.connect(),S.on("move",(e=>{const n=new v.a(t.fen());n.move(e),a(n)})),()=>{S.disconnect()})),[t]),Object(n.useEffect)((()=>{(async()=>{const t=await m.a.get("http://localhost:5000/api/games/".concat(e)),n=new v.a(t.data.boardState);a(n)})()}),[e]);return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Game"}),Object(i.jsx)(x.a,{position:t.fen(),onPieceDrop:(n,c)=>((n,c)=>{const r=new v.a(t.fen()),s=r.move({from:n,to:c,promotion:"q"});if(null===s)return;const o=(e=>e.in_checkmate()?"b"===e.turn()?"player1":"player2":e.in_draw()?"draw":"ongoing")(r);a(r),S.emit("move",{gameId:e,move:s,fen:r.fen(),turn:r.turn(),result:o})})(n,c)}),Object(i.jsx)(C,{gameId:e})]})};var W=()=>{const[e,t]=Object(n.useState)([]),a=Object(l.p)();Object(n.useEffect)((()=>{(async()=>{const e=localStorage.getItem("token"),a=await m.a.get("http://localhost:5000/api/games/mygames",{headers:{"x-auth-token":e}});t(a.data)})()}),[]);return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Games"}),Object(i.jsx)("button",{onClick:async()=>{const a=localStorage.getItem("token"),n=await m.a.post("http://localhost:5000/api/games/create",{player2Id:"some-player2-id"},{headers:{"x-auth-token":a}});t([...e,n.data])},children:"Create Game"}),Object(i.jsx)("ul",{children:e.map((e=>Object(i.jsxs)("li",{onClick:()=>{return t=e._id,void a("/game/".concat(t));var t},children:["Game between ",e.player1," and ",e.player2]},e._id)))})]})};var q=e=>{let{children:t}=e;return localStorage.getItem("token")?t:Object(i.jsx)(l.a,{to:"/login"})};var G=function(){return Object(i.jsx)(o.a,{children:Object(i.jsxs)(l.d,{children:[Object(i.jsx)(l.b,{path:"/",element:Object(i.jsx)(j,{})}),Object(i.jsx)(l.b,{path:"/login",element:Object(i.jsx)(g,{})}),Object(i.jsx)(l.b,{path:"/register",element:Object(i.jsx)(p,{})}),Object(i.jsx)(l.b,{path:"/games",element:Object(i.jsx)(q,{children:Object(i.jsx)(W,{})})}),Object(i.jsx)(l.b,{path:"/game/:gameId",element:Object(i.jsx)(q,{children:Object(i.jsx)(E,{})})})]})})};a(149);s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(G,{})}),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.af594e6d.chunk.js.map